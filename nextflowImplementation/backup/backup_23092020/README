version working fine,
but I had to improve the repeat finding step introducing red
