Produce a local repository of all the R packages needed by gip.

1) access the current (03102020) singularity container, mounting a working folder:
   
  sudo singularity shell --writable --no-home -B ../inputData:/mnt gipContainerDev.simg/
  cd /mnt
  
2) call R, and use these commands:

  ip <- as.data.frame(installed.packages()[,c(1,3:4)])
  ip <- rbind(ip,data.frame(Package="conquer" , Version="1.0.2", Priority=NA , row.names="conquer"))
  write.table(file="Rpkgs.tsv",x=ip,row.names=F,col.names=T,sep="\t",quote=F)
  

This will print the list of all the installed packages, and their version.
Save this table to the file "Rpkgs.tsv"
You manually added "conquer" because it is a needed dependency, but for some reason is not part of the intalled packages.
Maybe it was not a needed a dependency at the time of building gipContainerDev.simg, but became a dependency later.

3) Run the script "buildMiniCran.R" adjusting the settings:
  pth <- "/mnt/miniCRAN"
  allPkgs <- read.table("/mnt/Rpkgs.tsv",header=T)

This will download the source (.tar.gz files) of all package of all packages.
Packages bisoreg, foreign and XML are not available anymore in R 3.6.0 so you need to manually download the source code and add it to the miniCRAN folder (and update the repository index).

4) Copy the singularity /mnt/miniCRAN repository in the Ubuntu VM folders:
  /home/gbussott/Desktop/GIP_githubRepo/singularityContainer/Rpkgs
  /home/gbussott/Desktop/GIP_githubRepo/singularityContainer/files

5) When you build the singularity container you run Rscript installRpkgs.R which: 
   (i) considers the miniCRAN folder (e.g. provided by files/packages.tar.gz file)
   (ii) install first XML (for some reasons, despite you updated the miniCRAN repository index, these packages are not correcly listed in the dependencies of the other packages and just ignored, so you need to install them first manually)
      R -e 'install.packages("XML_3.99-0.3.tar.gz", repos = NULL, type="source")'
   (iii) install all the other packages with R install.packages() specifying the local source repository miniCRAN
   (iv) install bisoreg
      R -e 'install.packages("bisoreg_1.5.tar.gz", repos = NULL, type="source")'

Please note that for some packages the version that is listed in Rpkgs.tsv and in miniCRAN (and thus installed) is different.
This is because Rpkgs.tsv is just a snapshot of the installed packages and their versions at a specific time.
Then, for some of the packages at the time I built miniCRAN the version was changed. While in Rpkgs.tsv there is the Version info, this is not used to build miniCRAN, and whatever newer version is availeble (in the limits od the same R3.6.0 version) is downloaded. These are the packages have an updated version in miniCRAN:

Rcpp_1.0.4.6
admisc_0.8
ape_5.4
backports_1.1.8
bit_1.1-15.2
bit64_0.9-7
car_3.0-8
data.table_1.12.8
dplyr_1.0.0
expm_0.999-4
fields_10.3
glue_1.4.1
gplots_3.0.3
htmlTable_2.0.0
httr_1.4.1
maptools_1.0-1
nloptr_1.2.2.1
pillar_1.4.4
pkgbuild_1.0.8
processx_3.4.2
ps_1.3.3
quantreg_5.55
rlang_0.4.6
sys_3.3
tibble_3.0.1
tinytex_0.24
vctrs_0.3.1
xfun_0.15
zip_2.0.4

This is not a problem since from now on gip will just use the packages that are not part of miniCRAN.

